# MUSTTODO โ ููุงุฑุฏ ุญุงุช ฺฉู ุจุงุฏ ุฏุฑ ุขูุฏู ูพุงุฏูโุณุงุฒ ุดููุฏ

> ุงู ูุงู ุดุงูู ูุณุช ููุงุฑุฏ ุญุงุช ุงุณุช ฺฉู ุจุฑุง MVP ุจูโุตูุฑุช ุณุงุฏู ุง ูููุช ูพุงุฏู ุดุฏูโุงูุฏ ู **ุญุชูุงู ุจุงุฏ** ูุจู ุงุฒ Production ุจูโุตูุฑุช ฺฉุงูู ู ุงูู ูพุงุฏูโุณุงุฒ ุดููุฏ.

---

## ๐ ุงููุช (CRITICAL)

### 1. Hash ฺฉุฑุฏู Password
**ูุถุนุช ูุนู**: Password ุจูโุตูุฑุช ุฎุงู (plain text) ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ูโุดูุฏ.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุงุณุชูุงุฏู ุงุฒ `bcrypt` ุง `argon2` ุจุฑุง hash ฺฉุฑุฏู password
- ุงุถุงูู ฺฉุฑุฏู salt ุจู ูุฑ password
- ูพุงุฏูโุณุงุฒ ุฏุฑ `core/security.py`:
  ```python
  from passlib.context import CryptContext
  pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")
  
  def hash_password(password: str) -> str:
      return pwd_context.hash(password)
  
  def verify_password(plain: str, hashed: str) -> bool:
      return pwd_context.verify(plain, hashed)
  ```
- ุขูพุฏุช ุชูุงู ุฌุงูุง ฺฉู password ุฐุฎุฑู ุง ุจุฑุฑุณ ูโุดูุฏ

**ุงูููุช**: ๐ด ุจุณุงุฑ ุจุงูุง  
**ูุจู ุงุฒ**: ูุฑ ุฏูพูู production

---

### 2. Hash/Sign ฺฉุฑุฏู OTP
**ูุถุนุช ูุนู**: OTP ุจูโุตูุฑุช ุฎุงู ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ูโุดูุฏ.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ฺฏุฒูู 1: Hash ฺฉุฑุฏู OTP ุจุง HMAC-SHA256 ูุจู ุงุฒ ุฐุฎุฑู
- ฺฏุฒูู 2: ุงุณุชูุงุฏู ุงุฒ JWT/Signed Token ุจุฌุง ุฐุฎุฑู ุฏุฑ DB
- ูพุดููุงุฏ: ุงุณุชูุงุฏู ุงุฒ ฺฉุชุงุจุฎุงูู `itsdangerous` ุจุฑุง ุชูฺฉูโูุง signed:
  ```python
  from itsdangerous import URLSafeTimedSerializer
  serializer = URLSafeTimedSerializer(settings.SECRET_KEY)
  
  def generate_otp_token(email: str) -> str:
      return serializer.dumps(email, salt="otp-salt")
  
  def verify_otp_token(token: str, max_age: int = 600) -> str:
      return serializer.loads(token, salt="otp-salt", max_age=max_age)
  ```

**ุงูููุช**: ๐ ุจุงูุง  
**ูุจู ุงุฒ**: ุฏูพูู production

---

### 3. Email Verification
**ูุถุนุช ูุนู**: ุฏุฑ ุงุณฺฉููพ ุฐฺฉุฑ ุดุฏู ุงูุง ูพุงุฏู ูุดุฏู.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุงุถุงูู ฺฉุฑุฏู ููุฏ `email_verified: bool` ุจู ูุฏู User
- ุงุฑุณุงู ููฺฉ ุชุฃุฏ ุงูู ูพุณ ุงุฒ ุซุจุชโูุงู
- ูุญุฏูุฏ ฺฉุฑุฏู ุฏุณุชุฑุณโูุง ุชุง ุฒูุงู ุชุฃุฏ ุงูู
- ุงูุฒูุฏู endpoint `/auth/verify-email`

**ุงูููุช**: ๐ ุจุงูุง  
**ูุจู ุงุฒ**: ุฑุงูโุงูุฏุงุฒ ุงูู ูุงูุน (ูพุณ ุงุฒ MailHog)

---

## ๐๏ธ ุฏุชุงุจุณ

### 4. Soft Delete
**ูุถุนุช ูุนู**: ุฑฺฉูุฑุฏูุง ุจูโุตูุฑุช ฺฉุงูู ุญุฐู ูโุดููุฏ (Hard Delete).

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุงุถุงูู ฺฉุฑุฏู ููุฏ `deleted_at: DateTime | None` ุจู ูุฏูโูุง ููู
- ุชุบุฑ DELETE endpoints ุจู UPDATE deleted_at
- ููุชุฑ ฺฉุฑุฏู queryูุง ุจุฑุง ุนุฏู ููุงุด ุฑฺฉูุฑุฏูุง ุญุฐูโุดุฏู
- ูุฏูโูุง ููู: User, Card, Community, Message

**ุงูููุช**: ๐ก ูุชูุณุท  
**ูุจู ุงุฒ**: MVP v1.0

---

### 5. ุจูููโุณุงุฒ Indexโูุง
**ูุถุนุช ูุนู**: Indexโูุง ุงููู ุจุฑุงุณุงุณ ุญุฏุณ ุงุถุงูู ุดุฏูโุงูุฏ.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุจุฑุฑุณ queryูุง ูุงูุน ุฏุฑ production
- ุงุณุชูุงุฏู ุงุฒ `EXPLAIN ANALYZE` ุจุฑุง ุดูุงุณุง slow queries
- ุงุถุงูู ฺฉุฑุฏู Indexโูุง composite ููุงุณุจ
- ุญุฐู Indexโูุง ุงุณุชูุงุฏูโูุดุฏู

**ุงูููุช**: ๐ก ูุชูุณุท  
**ุจุนุฏ ุงุฒ**: MVP ู ูุดุงูุฏู ุชุฑุงูฺฉ ูุงูุน

---

### 6. Transaction Management
**ูุถุนุช ูุนู**: Transactionูุง ุจูโุตูุฑุช ุณุงุฏู ูุฏุฑุช ูโุดููุฏ.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุงุถุงูู ฺฉุฑุฏู transaction management ุฏุฑ ุณุฑูุณโูุง ุจุง ฺูุฏ query
- ูพุงุฏูโุณุงุฒ rollback ุฏุฑ ุตูุฑุช ุฎุทุง
- ูุซุงู: ุณุงุฎุช ฺฉุงูููุช + ุนุถูุช ุฎูุฏฺฉุงุฑ owner ุจุงุฏ atomic ุจุงุดุฏ

**ุงูููุช**: ๐ก ูุชูุณุท  
**ูุจู ุงุฒ**: MVP v1.0

---

## ๐ ุจูุจูุฏ ฺฉุฏ

### 7. ุงุณุชูุงุฏู ุงุฒ Enum ุจุฌุง Boolean
**ูุถุนุช ูุนู**: ููุฏูุง ูุซู `is_sender` ู `is_packed` boolean ูุณุชูุฏ.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุชุจุฏู `is_sender` ุจู `card_type: Enum['TRAVEL', 'PACKAGE']`
- ุชุจุฏู `is_packed` ุจู `packaging_status: Enum['UNPACKED', 'PACKED', 'FRAGILE']`
- ุชุจุฏู `is_approved` ุจู `request_status: Enum['PENDING', 'APPROVED', 'REJECTED']`
- ุฎูุงูุง ู ุชูุณุนูโูพุฐุฑ ุจุดุชุฑ

**ุงูููุช**: ๐ก ูุชูุณุท  
**ูุจู ุงุฒ**: MVP v2.0

---

### 8. Proper Error Handling
**ูุถุนุช ูุนู**: ุฎุทุงูุง ุจูโุตูุฑุช ุณุงุฏู handle ูโุดููุฏ.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุชุนุฑู Custom Exception Classes
- Centralized error handler ุฏุฑ FastAPI
- ูุงฺฏ ฺฉุฑุฏู ุฎุทุงูุง ุจุง ุฌุฒุฆุงุช (ุจุฏูู leak ุงุทูุงุนุงุช ุญุณุงุณ)
- ูพุงุฏูโุณุงุฒ ุฏุฑ `core/exceptions.py`

**ุงูููุช**: ๐ข ูพุงู  
**ุจุนุฏ ุงุฒ**: MVP

---

### 9. Rate Limiting ูพุดุฑูุชู
**ูุถุนุช ูุนู**: rate limit ุณุงุฏู ุจุง Redis.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- Sliding Window ุจุฌุง Fixed Window
- Rate limit ูุฌุฒุง ุจุฑุง ูุฑ endpoint
- Whitelist ุจุฑุง IPูุง ูุทูุฆู
- ุงุทูุงุนโุฑุณุงู ุจู ฺฉุงุฑุจุฑ ุฏุฑุจุงุฑู ุจุงููุงูุฏู quota

**ุงูููุช**: ๐ข ูพุงู  
**ุจุนุฏ ุงุฒ**: ูุดุงูุฏู ุชุฑุงูฺฉ ูุงูุน

---

## ๐ ูุงูุชูุฑูฺฏ

### 10. Structured Logging
**ูุถุนุช ูุนู**: ูุงฺฏโูุง ุณุงุฏู.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุงุณุชูุงุฏู ุงุฒ `structlog` ุจุฑุง JSON logging
- ุงุถุงูู ฺฉุฑุฏู context ุจู ูุฑ ูุงฺฏ (user_id, request_id, ...)
- ุงุฑุณุงู ูุงฺฏโูุง ุจู ุณุฑูุณ ูุฑฺฉุฒ (Logtail/Datadog/...)

**ุงูููุช**: ๐ก ูุชูุณุท  
**ูุจู ุงุฒ**: Production

---

### 11. Performance Monitoring
**ูุถุนุช ูุนู**: ุจุฏูู ูุงูุชูุฑูฺฏ.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ูุตุจ Sentry ุจุฑุง error tracking
- ุงุถุงูู ฺฉุฑุฏู metrics (response time, DB query count, ...)
- Alert ุจุฑุง ุฎุทุงูุง ุญุงุช
- Dashboard ุจุฑุง ูุดุงูุฏู ูุถุนุช ุณุณุชู

**ุงูููุช**: ๐ ุจุงูุง  
**ูุจู ุงุฒ**: Production

---

## ๐งช ุชุณุช

### 12. ุงูุฒุงุด Coverage
**ูุถุนุช ูุนู**: ุชุณุชโูุง ูููุงู.

**ุจุงุฏ ุงูุฌุงู ุดูุฏ**:
- ุฑุณุฏู ุจู ุญุฏุงูู 80% test coverage
- ุชุณุชโูุง integration ุจุฑุง flowูุง ฺฉุงูู
- ุชุณุชโูุง security (SQL injection, XSS, CSRF, ...)
- ุชุณุชโูุง performance/load

**ุงูููุช**: ๐ก ูุชูุณุท  
**ูุจู ุงุฒ**: MVP v1.0

---

## ๐ ฺฺฉโูุณุช ูุจู ุงุฒ Production

ูุจู ุงุฒ ุฏูพูู productionุ ุงู ููุงุฑุฏ ุฑุง ุจุฑุฑุณ ฺฉู:

- [ ] โ Password hashing ูพุงุฏู ุดุฏู
- [ ] โ OTP signing/hashing ูพุงุฏู ุดุฏู
- [ ] โ Email verification ูุนุงู
- [ ] โ HTTPS ุชูุธู ุดุฏู
- [ ] โ CORS ุจู ุฏุฑุณุช ุชูุธู ุดุฏู
- [ ] โ SECRET_KEY ูู ู ฺฉุชุง
- [ ] โ Database backup ุชูุธู ุดุฏู
- [ ] โ Error monitoring (Sentry) ูุนุงู
- [ ] โ Structured logging ูพุงุฏู ุดุฏู
- [ ] โ Rate limiting ุชุณุช ุดุฏู
- [ ] โ SQL injection testing ุงูุฌุงู ุดุฏู
- [ ] โ Dependencies ุจู ุขุฎุฑู ูุณุฎู stable ุขูพุฏุช ุดุฏู
- [ ] โ Environment variables ุงุฒ .env.production ุฎูุงูุฏู ูโุดููุฏ
- [ ] โ DEBUG=False ุฏุฑ production

---

**ุงุฏุขูุฑ**: ุงู ููุงุฑุฏ ุฎุท ูุฑูุฒ ูุณุชูุฏ. ูฺโฺฉุฏุงู ุงุฎุชุงุฑ ูุณุชูุฏ.

**ุขุฎุฑู ุจูโุฑูุฒุฑุณุงู**: 2025-11-02

